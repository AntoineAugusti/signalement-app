<form [formGroup]="searchForm" (submit)="searchCompany()" id="searchForm">
  <div class="form__group">
    <label for="searchInput">
      Veuillez rechercher l'établissement (nom, type, adresse, ville, ...) <span>*</span>
    </label>
    <div class="input-group">
      <input type="text" class="form-control" formControlName="search" name="search" id="searchInput" placeholder="ex : boulangerie Petit Jean Orléans ..." />
      <div class="input-group-append">
        <button type="submit" class="btn btn-secondary d-sm-none"><svg class="icon icon-search"><use xlink:href="#magnifier"></use></svg></button>
        <button type="submit" class="btn btn-secondary d-none d-sm-block">Rechercher</button>
      </div>
    </div>
    <div class="invalid" *ngIf="showErrors && searchCtrl.hasError('required')">
      Veuillez renseigner le champ de recherche.
    </div>
  </div>
</form>

<div class="notification error mt-4" *ngIf="searchWarning">
  <p>
    {{searchWarning}}
  </p>
  Veuillez modifier votre recherche ou <span class="link" (click)="editCompany()">saisir l'établissement manuellement</span>.
</div>

<form [formGroup]="companyForm" (submit)="submitCompanyForm()" id="companyForm" *ngIf="companyForm">

  <div class="form__group">
    <label for="companyName">
      Nom de l'établissement <span>*</span>
    </label>
    <input formControlName="name" type="text" id="companyName" placeholder="Nom de l'établissement">
    <div class="invalid" *ngIf="showErrors && nameCtrl.hasError('required')">
      Veuillez compléter le nom de l'établissement.
    </div>
  </div>

  <div class="form__group">
    <label for="companyAddress">
      Adresse de l'établissement <span>*</span>
    </label>
    <ng2-completer
      [datasource]="addressData"
      formControlName="address"
      inputName="address"
      inputId="companyAddress"
      textSearching=""
      textNoResults=""
      minSearchLength="1"
      placeholder="numéro, voie, code postal, ville, ..."
      (selected)="selectAddress($event)">
    </ng2-completer>
    <div class="invalid" *ngIf="showErrors && addressCtrl.hasError('required')">
      Veuillez préciser l'adresse de l'établissement.
    </div>
  </div>

  <div class="text-center mt-3">
    <button class="button secondary" type="submit" id="submitCompanyForm">Valider</button>
  </div>

</form>

<div *ngIf="companies && companies.length">

  <div class="notification warning mt-4">
    Veuillez sélectionner un établissement dans la liste ci-dessous
  </div>

  <p *ngFor="let company of companies" class="company" (click)="selectCompanyFromResults(company)">
    <span *ngIf="company.line1">{{company.line1}}<br /></span>
    <span *ngIf="company.line2">{{company.line2}}<br /></span>
    <span *ngIf="company.line3">{{company.line3}}<br /></span>
    <span *ngIf="company.line4">{{company.line4}}<br /></span>
    <span *ngIf="company.line5">{{company.line5}}<br /></span>
    <span *ngIf="company.line6">{{company.line6}}<br /></span>
    <span *ngIf="company.line7">{{company.line7}}<br /></span>
  </p>
</div>

<ngx-loading [show]="loading"></ngx-loading>
